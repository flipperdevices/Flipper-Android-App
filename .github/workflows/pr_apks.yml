name: Artifacts Pull Request CI

on:
  pull_request:
    branches:
      - 'dev'

jobs:
  pr_artifact:
    name: "Build an application and publish it as an artifact"
    permissions:
      contents: write
      pull-requests: write
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          submodules: 'recursive'
      - name: Set up JDK 1.17
        uses: actions/setup-java@v2
        with:
          distribution: 'temurin'
          java-version: '17'
      - name: Build debug apks
        uses: gradle/gradle-build-action@v2
        with:
          arguments: assembleDebug
      - name: Sign Android Debug APK
        id: sign_android_apk
        uses: r0adkll/sign-android-release@v1
        with:
          releaseDirectory: instances/app/build/outputs/apk/debug
          signingKeyBase64: "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"
          alias: debug
          keyStorePassword: password
          keyPassword: password
      - name: Sign Wear Debug APK
        id: sign_wear_apk
        uses: r0adkll/sign-android-release@v1
        with:
          releaseDirectory: instances/wearable/build/outputs/apk/debug
          signingKeyBase64: "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"
          alias: debug
          keyStorePassword: password
          keyPassword: password
      - name: Pull request artifacts
        uses: gavv/pull-request-artifacts@v1.1.0
        with:
          # Commit hash that triggered PR
          commit: ${{ github.event.pull_request.head.sha }}

          # Token for current repo (used to post PR comment)
          repo-token: ${{ secrets.GITHUB_TOKEN }}

          # Optional, uncomment to upload to another repository
          #artifacts-token: ${{ secrets.ANOTHER_TOKEN_WITH_PUSH_ACCESS }}
          #artifacts-repo: some/repository_name

          # Optional, uncomment to upload artifacts to specific branch, otherwise
          # the default branch is used.
          # Note that usually the main branch is protected by rules, so it's not
          # possible to upload there.
          # Perhaps, the best solution is to create an empty unprotected branch
          # dedicated for artifacts.
          # See README for details.
          artifacts-branch: pr_artifacts

          # Whitespace-separated list of files to upload
          artifacts: |
            instances/app/build/outputs/apk/debug/app-debug.apk
            instances/wearable/build/outputs/apk/debug/wearable-debug.apk
